<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="646px" preserveAspectRatio="none" style="width:644px;height:646px;background:#FFFFFF;" version="1.1" viewBox="0 0 644 646" width="644px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="556.0625" style="stroke:#181818;stroke-width:1.0;" width="10" x="118" y="46.2969"/><rect fill="#FFFFFF" height="556.0625" style="stroke:#181818;stroke-width:1.0;" width="10" x="354" y="46.2969"/><rect fill="#FFFFFF" height="267.0625" style="stroke:#181818;stroke-width:1.0;" width="10" x="542" y="335.2969"/><rect height="335.2656" style="stroke:#000000;stroke-width:1.5;fill:none;" width="619.5" x="18" y="194.8281"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="123" x2="123" y1="36.2969" y2="611.3594"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="359" x2="359" y1="36.2969" y2="611.3594"/><line style="stroke:#181818;stroke-width:0.5;fill:none;stroke-dasharray:5.0,5.0;" x1="546.5" x2="546.5" y1="36.2969" y2="611.3594"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="56" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="63" y="24.9951">app: Application</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="56" y="610.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="63" y="630.3545">app: Application</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166" x="276" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="283" y="24.9951">cm: ContentManager</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="166" x="276" y="610.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="152" x="283" y="630.3545">cm: ContentManager</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161" x="466.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="473.5" y="24.9951">item: DownloadItem</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="161" x="466.5" y="610.3594"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="147" x="473.5" y="630.3545">item: DownloadItem</text><rect fill="#FFFFFF" height="556.0625" style="stroke:#181818;stroke-width:1.0;" width="10" x="118" y="46.2969"/><rect fill="#FFFFFF" height="556.0625" style="stroke:#181818;stroke-width:1.0;" width="10" x="354" y="46.2969"/><rect fill="#FFFFFF" height="267.0625" style="stroke:#181818;stroke-width:1.0;" width="10" x="542" y="335.2969"/><path d="M21,51.2969 L21,76.2969 L224,76.2969 L224,61.2969 L214,51.2969 L21,51.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M214,51.2969 L214,61.2969 L224,61.2969 L214,51.2969 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="27" y="68.3638">User enters media info page</text><path d="M49,86.4297 L49,111.4297 L196,111.4297 L196,96.4297 L186,86.4297 L49,86.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M186,86.4297 L186,96.4297 L196,96.4297 L186,86.4297 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="55" y="103.4966">Check if item exists</text><polygon fill="#181818" points="342,133.6953,352,137.6953,342,141.6953,346,137.6953" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="128" x2="348" y1="137.6953" y2="137.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="135" y="132.6294">findItem(itemId)</text><line style="stroke:#181818;stroke-width:1.0;" x1="364" x2="406" y1="166.8281" y2="166.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="406" x2="406" y1="166.8281" y2="179.8281"/><line style="stroke:#181818;stroke-width:1.0;" x1="365" x2="406" y1="179.8281" y2="179.8281"/><polygon fill="#181818" points="375,175.8281,365,179.8281,375,183.8281,371,179.8281" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="371" y="161.7622">lookup(itemId)</text><path d="M18,194.8281 L84,194.8281 L84,201.9609 L74,211.9609 L18,211.9609 L18,194.8281 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="335.2656" style="stroke:#000000;stroke-width:1.5;" width="619.5" x="18" y="194.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="33" y="207.895">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="85" x="99" y="207.0386">[item found]</text><polygon fill="#181818" points="139,229.0938,129,233.0938,139,237.0938,135,233.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="133" x2="353" y1="233.0938" y2="233.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="145" y="228.0278">item</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="18" x2="637.5" y1="242.0938" y2="242.0938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="78" x="23" y="252.3042">[not found]</text><polygon fill="#181818" points="139,273.0313,129,277.0313,139,281.0313,135,277.0313" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="133" x2="353" y1="277.0313" y2="277.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22" x="145" y="271.9653">null</text><polygon fill="#181818" points="342,302.1641,352,306.1641,342,310.1641,346,306.1641" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="128" x2="348" y1="306.1641" y2="306.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="135" y="301.0981">createItem(itemId, contentURL)</text><polygon fill="#181818" points="530,331.2969,540,335.2969,530,339.2969,534,335.2969" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="364" x2="536" y1="335.2969" y2="335.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="371" y="330.231">new(itemId, contentURL)</text><polygon fill="#181818" points="139,360.4297,129,364.4297,139,368.4297,135,364.4297" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="133" x2="353" y1="364.4297" y2="364.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29" x="145" y="359.3638">item</text><polygon fill="#181818" points="342,389.5625,352,393.5625,342,397.5625,346,393.5625" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="128" x2="348" y1="393.5625" y2="393.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="135" y="388.4966">loadMetadata()</text><path d="M215,406.5625 L215,431.5625 L503,431.5625 L503,416.5625 L493,406.5625 L215,406.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M493,406.5625 L493,416.5625 L503,416.5625 L493,406.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267" x="221" y="423.6294">Download and parse manifest, save in db</text><polygon fill="#181818" points="139,453.8281,129,457.8281,139,461.8281,135,457.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="133" x2="353" y1="457.8281" y2="457.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="145" y="452.7622">onTracksAvailable</text><polygon fill="#181818" points="139,482.9609,129,486.9609,139,490.9609,135,486.9609" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="133" x2="353" y1="486.9609" y2="486.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="145" y="481.895">onDownloadMetadata</text><path d="M28,499.9609 L28,524.9609 L218,524.9609 L218,509.9609 L208,499.9609 L28,499.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M208,499.9609 L208,509.9609 L218,509.9609 L208,499.9609 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><ellipse cx="39.5" cy="512.5938" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="47" y="517.0278">See</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="97" x="75" y="517.0278">track-selection</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27" x="176" y="517.0278">flow</text><path d="M5,542.0938 L5,567.0938 L241,567.0938 L241,552.0938 L231,542.0938 L5,542.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M231,542.0938 L231,552.0938 L241,552.0938 L231,542.0938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215" x="11" y="559.1606">app is ready to start downloading</text><polygon fill="#181818" points="530,589.3594,540,593.3594,530,597.3594,534,593.3594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="128" x2="536" y1="593.3594" y2="593.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="135" y="588.2935">startDownload()</text><!--MD5=[1f901aac4db69900db89d2fe39626aa4]
@startuml
participant "app: Application" as app
    participant "cm: ContentManager" as cm
    participant "item: DownloadItem" as item
    
    activate app
    activate cm
    
    note over app: User enters media info page
    
    note over app: Check if item exists
    app->cm: findItem(itemId)
    cm->cm: lookup(itemId)
    
    alt item found
        cm- ->app: item
    else not found
        cm- ->app: null
        app->cm: createItem(itemId, contentURL)
        cm->item: new(itemId, contentURL)
        activate item
        cm- ->app: item
    
        app->cm: loadMetadata()
        note over cm
            Download and parse manifest, save in db
        end note
        cm- ->app: onTracksAvailable
        cm- ->app: onDownloadMetadata
        note over app: * See //track-selection// flow
    end group
    
    note over app: app is ready to start downloading
    app->item: startDownload()
@enduml

PlantUML version 1.2022.6beta2(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>